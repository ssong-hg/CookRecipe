<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="header.css">
	<link rel="stylesheet" href="search/category.css">
	<link rel="stylesheet" href="search/search.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"/>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="/js/jQuery-2.1.4.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.js"></script>
	
	<title>search</title>
</head>
<body bgcolor=#fffff3>
	<header>
		<div class= "menu">
			<div id="nav">
				<ul>
					<br>
		            <li class="menuBtn"><a th:href="@{/mypage}">MY PAGE</a></li><br>
		            <li class="menuBtn"><a href="#">menu2</a></li><br>
		            <li class="menuBtn"><a href="#">menu3</a></li><br>
		            <li class="menuBtn"> <a  th:href="@{/createrecipe/createcookrecipe}">레시피 만들기</a></li><br>
		            <li class="menuBtn"><a  th:href="@{/question/list}">자유게시판</a></li><br>
		            
		            <th:block th:if="${session.admin != null}">
		            	<li class="menuBtn" ><a href="/admin/master">Admin</a></li>
		            </th:block>
		            
		           <th:block th:if="${session.admin == null}">
		            <li class="menuBtn"><a  th:href="@{/admin/create}">관리자에게 물어보기!</a></li><br>
		            </th:block>		 
		        </ul>
		        <a href="#" id="navBtn"><i class="fas fa-bars"></i></a>
			</div>
        	
    		<div id="logo">
    			<a th:href="@{/main}"><h1>I'm chef</h1></a>
    		</div> 
    		
    		<div id="login">
    		    <ul>
               		 <th:block th:if="${session.member == null}">
        				<li><a class="logBtn" th:href="@{/login}">로그인</a></li>
    				</th:block>
    				<th:block th:if="${session.member != null}">
        				<li class="loginId" ><a class="nickName" th:href="@{/mypage}">[[${session.member.nickName}]]</a><span>     ([[${session.member.grade.gradeName}]])님 환영합니다</span>
				      		  <a class="logBtn" th:href="@{/logout}">로그아웃</a></li>
    				</th:block>
    			</ul>
			</div>
    		
		</div>
	</header>
	<hr>
	<div class="category" th:if="${search == 'rcpWay2'}">
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{볶기}" >
				<button type="submit"><img src="search/panfry.gif" alt="이미지"></button><br>
				<li>볶기</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{굽기}" >
				<button type="submit"><img src="search/bbq.gif" alt="이미지"></button><br>
				<li>굽기</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{끓이기}" >
				<button type="submit"><img src="search/boil.gif" alt="이미지"></button><br>
				<li>끓이기</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{찌기}" >
				<button type="submit"><img src="search/steamer.gif" alt="이미지"></button><br>
				<li>찌기</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{튀기기}" >
				<button type="submit"><img src="search/saucepan.gif" alt="이미지"></button><br>
				<li>튀기기</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{기타}" >
				<button type="submit"><img src="search/guitar.gif" alt="이미지"></button><br>
				<li>기타</li>
			</div>
		</form>
	</div><!-- 요리방법 -->
	<div class="category" th:if="${search == 'rcpPat2'}">
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{반찬}" >
				<button type="submit"><img src="search/sidedish.gif" alt="이미지"></button><br>
				<li>반찬</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{국&찌개}" >
				<button type="submit"><img src="search/soup.gif" alt="이미지"></button><br>
				<li>국&찌개</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{일품}" >
				<button type="submit"><img src="search/trolley.gif" alt="이미지"></button><br>
				<li>일품</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{밥}" >
				<button type="submit"><img src="search/rice.gif" alt="이미지"></button><br>
				<li>밥</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{후식}" >
				<button type="submit"><img src="search/cake.gif" alt="이미지"></button><br>
				<li>후식</li>
			</div>
		</form>
		<form action="/category" method="get">
			<div>
				<input type="hidden" name="category" th:value="@{기타}" >
				<button type="submit"><img src="search/guitar.gif" alt="이미지"></button><br>
				<li>기타</li>
			</div>
		</form>
	</div><!-- 요리분류 -->
	<div id="category" th:if="${search == 'rcpPartsDtls'}">
		<div class="category2">
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{meat}" >
					<button type="submit"><img src="search/chicken.gif" alt="이미지"></button><br>
					<li>육류</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{seaFood}" >
					<button type="submit"><img src="search/shrimp.gif" alt="이미지"></button><br>
					<li>해물</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{vagetables}" >
					<button type="submit"><img src="search/carrot.gif" alt="이미지"></button><br>
					<li>채소</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{eggAndMilks}" >
					<button type="submit"><img src="search/egg.gif" alt="이미지"></button><br>
					<li>계란/유제품</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{processedFood}" >
					<button type="submit"><img src="search/ham.gif" alt="이미지"></button><br>
					<li>가공식품</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{fruit}" >
					<button type="submit"><img src="search/apple.gif" alt="이미지"></button><br>
					<li>과일</li>
				</div>
			</form>
		</div>
		<div class="category2">
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{nuts}" >
					<button type="submit"><img src="search/nut.gif" alt="이미지"></button><br>
					<li>견과류</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{corn}" >
					<button type="submit"><img src="search/corn.gif" alt="이미지"></button><br>
					<li>곡류</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{wheat}" >
					<button type="submit"><img src="search/wheat.gif" alt="이미지"></button><br>
					<li>밀가루</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{stockFish}" >
					<button type="submit"><img src="search/sea.gif" alt="이미지"></button><br>
					<li>건어물</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{mushroom}" >
					<button type="submit"><img src="search/mushroom.gif" alt="이미지"></button><br>
					<li>버섯</li>
				</div>
			</form>
			<form action="/category2" method="get">
				<div>
					<input type="hidden" name="category" th:value="@{etc}" >
					<button type="submit"><img src="search/guitar.gif" alt="이미지"></button><br>
					<li>기타</li>
				</div>
			</form>
		</div>
	</div><!-- 요리재료 -->

	<div class="table">
    	<div th:each="cookRecipe, loop : ${paging}">
        	<ul>
            	<li class="title">[[${cookRecipe.rcpNm}]]</li>
            </ul>
            <ul class="sub">
            	<li> 별점 : [[${cookRecipe.StarScoreAvg}]]</li>  
                <li> 조회수 : [[${cookRecipe.readCount}]] </li> 
                           	
	            <th:block th:if="${session.member == null}">
	             <li class="wishListBtn"> 
        			<button type="button"  disabled="disabled" th:value="${cookRecipe.rcpSeq}" class="wishList" id="w1">찜하기(로그인필요)</button>
        		</li>	
    			</th:block>
    			<th:block th:if="${session.member != null}">
    			 <li class="wishListBtn">
        			<button type="button"  th:value="${cookRecipe.rcpSeq}" class="wishList" >찜 하기</button>
        		</li>
    			</th:block>
    			
    		</ul>	
    		<ul>	   
	            <a class="rcpSeq" id="rcpSeq" th:href="@{detail/}+${cookRecipe.rcpSeq}">
	                <img id="imgId" th:src="${cookRecipe.attFileNoMain}" 
	                    	alt="첨부이미지" th:if="${cookRecipe.attFileNoMain != null}">
		        </a>
	     	</ul><!--  -->
	        <ul class="text">                    
            	<li>조리방법 : [[${cookRecipe.rcpWay2}]]</li>
				<li>요리구분 : [[${cookRecipe.rcpPat2}]]</li>
				
	        </ul>
	        <br>
	        <hr>
    	</div>
    <!-- 페이징처리 시작 -->
	<div th:if="${paging != null}">
        <ul class="pagination justify-content-center">
        	<!-- 이전 버튼 -->
            <li class="page-item" th:classappend="${!paging.hasPrevious} ? 'disabled'">
               	<a class="page-link" th:href="@{|/category?category=${category}&page=${paging.number-1}|}">
                    <span>이전</span>
                </a>
            </li>
            <!-- 페이지 번호 -->
            <li th:each="page: ${#numbers.sequence(0, paging.totalPages-1)}"
            	th:if="${page >= paging.number-4 and page <= paging.number+4}"
                th:classappend="${page == paging.number} ? 'active'" 
                class="page-item">
                <a th:text="${page+1}" class="page-link" th:href="@{|/category?category=${category}&page=${page}|}"></a>
            </li>
            <!-- 다음 버튼 -->
            <li class="page-item" th:classappend="${!paging.hasNext} ? 'disabled'">
                <a class="page-link" th:href="@{|/category?category=${category}&page=${paging.number+1}|}">
                   	<span>다음</span>
                </a>
            </li>
        </ul>
    </div>
    <!-- 페이징처리 끝 -->
	    

	
</body>
<script>
	var nav= $('#nav ul li');
	$('#navBtn').click(function()
        {
            $('#nav').toggleClass('menu');
            if($('#nav').hasClass('menu'))
            {
            $('#nav').animate({left:'0'},400);
            
        }
            else
            {
            $('#nav').animate({left:'-400px'},400);
            
            }
        });
</script>
<script>


	var rcpSeq = document.getElementById('rcpSeq');	
	$(document).on( 'click', '.wishList', function() {
		
		console.log(event.target.value);
		$.ajax({
			url:'/wishlist',
			dataType : 'text',
			type:'GET',
			data:{
				rcpSeq:$(event.target).val()				
			},
			success: function (result){
				if(result == 'notNull'){
					console.log("실패");
					alert("이미 찜 목록에 있습니다");
					
				}else{
					console.log("성공");
					alert("찜 목록에 추가되었습니다");
				}
				
				
			},
			error: function (xhr) {
				console.log(xhr);
				alert(xhr.status + ':' + xhr.statusText);
			}			
		}) // $.ajax end
	}); // wishlist click end


</script>
</html>